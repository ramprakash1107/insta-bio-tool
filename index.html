<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Online Ludo 2 Player</title>

<style>
body{
  margin:0;
  background:#111;
  color:#fff;
  font-family:system-ui;
  text-align:center;
}
h2{margin:10px 0}
#login input,#login button{
  width:90%;
  padding:14px;
  margin:8px;
  border-radius:12px;
  border:none;
  font-size:16px;
}
button{
  background:#1d9bf0;
  color:#fff;
  font-weight:bold;
}
#board{
  width:260px;
  height:260px;
  margin:20px auto;
  display:grid;
  grid-template:repeat(5,1fr)/repeat(5,1fr);
}
.cell{
  border:1px solid #333;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
}
.red{color:#ff5252}
.blue{color:#4fc3f7}
#game{display:none}
</style>
</head>

<body>

<div id="login">
  <h2>ðŸŽ² Online Ludo</h2>
  <input id="room" placeholder="Room ID">
  <button onclick="createRoom()">Create Room</button>
  <button onclick="joinRoom()">Join Room</button>
</div>

<div id="game">
  <h3 id="turn">Turn:</h3>
  <div id="board"></div>
  <button onclick="rollDice()">ðŸŽ² Roll Dice</button>
  <h3 id="dice">-</h3>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getDatabase, ref, set, onValue, get } 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

/* ðŸ”¥ AAPKA FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyARuO_pN2vdYrVKYkKHHaNys7WI8HqM6I4",
  authDomain: "friendchat-43941.firebaseapp.com",
  databaseURL: "https://friendchat-43941-default-rtdb.firebaseio.com",
  projectId: "friendchat-43941",
  storageBucket: "friendchat-43941.firebasestorage.app",
  messagingSenderId: "1026542245723",
  appId: "1:1026542245723:web:b892bfcc1d2358a018ac7e"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

let roomId="", player="";
let pos={red:0,blue:0};

/* BOARD */
const board=document.getElementById("board");
for(let i=0;i<25;i++){
  const d=document.createElement("div");
  d.className="cell";
  d.id="c"+i;
  board.appendChild(d);
}

window.createRoom=async()=>{
  roomId=document.getElementById("room").value.trim();
  if(!roomId) return alert("Room ID likho");
  player="red";
  await set(ref(db,"ludo/"+roomId),{
    turn:"red",
    pos:{red:0,blue:0}
  });
  start();
}

window.joinRoom=()=>{
  roomId=document.getElementById("room").value.trim();
  if(!roomId) return alert("Room ID likho");
  player="blue";
  start();
}

function start(){
  document.getElementById("login").style.display="none";
  document.getElementById("game").style.display="block";

  onValue(ref(db,"ludo/"+roomId),snap=>{
    if(!snap.exists()) return;
    const data=snap.val();
    pos=data.pos;
    document.getElementById("turn").innerText="Turn: "+data.turn;
    draw();
  });
}

window.rollDice=async()=>{
  const snap=await get(ref(db,"ludo/"+roomId));
  const data=snap.val();
  if(data.turn!==player){
    alert("Wait for your turn");
    return;
  }
  const d=Math.floor(Math.random()*6)+1;
  document.getElementById("dice").innerText=d;
  data.pos[player]+=d;
  data.turn=player==="red"?"blue":"red";
  await set(ref(db,"ludo/"+roomId),data);
}

function draw(){
  document.querySelectorAll(".cell").forEach(c=>c.innerHTML="");
  if(pos.red<25) document.getElementById("c"+pos.red).innerHTML="<b class='red'>R</b>";
  if(pos.blue<25) document.getElementById("c"+pos.blue).innerHTML="<b class='blue'>B</b>";
}
</script>
</body>
</html>
